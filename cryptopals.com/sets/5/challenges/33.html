<html>
  <head>
    <meta content='text/html; charset=utf-8' http-equiv='content-type'>
    <meta content='Thomas Ptacek, Sean Devlin, and Alex Balducci' name='author'>
    <title>Challenge 33 Set 5 - The Cryptopals Crypto Challenges</title>
    <link href='../../../static/bootstrap.css' media='all' rel='stylesheet' type='text/css'>
    <link href='../../../static/app.css' media='all' rel='stylesheet' type='text/css'>
    <link href='https://cloud.typography.com/6817512/661724/css/fonts.css' rel='stylesheet' type='text/css'>
    <link href='https://cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.css' rel='stylesheet' type='text/css'>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.js'></script>
    <style>
      body { 
        padding: 20px;
      }
    </style>
  </head>
  <body>
    <div class='container'>
      <div class='row'>
        <div class='col-md-12'>
          <h3>
            <a href='../../../index.html'>the cryptopals crypto challenges</a>
          </h3>
        </div>
      </div>

      <div class='row'>
        <div class='col-md-12'>
          <ul class='breadcrumb'>
            <li>
              <a href='../../../index.html'>Challenges</a>
            </li>
            <li>
              <a href='../../5.html'>Set 5</a>
            </li>
            <li class='active'>
              <a href='33.html'>Challenge 33</a>
            </li>
          </ul>
        </div>
      </div>
      <div class='row'>
        
        <div class='col-md-2'></div>
        <div class='col-md-10'>
          <h3>Implement Diffie-Hellman</h3>
          <p>
  For one of the most important algorithms in cryptography this exercise
  couldn't be a whole lot easier.
</p>
<p>
  Set a variable "p" to 37 and "g" to 5. This algorithm is so easy I'm not even
  going to explain it. Just do what I do.
</p>
<p>
  Generate "a", a random number mod 37. Now generate "A", which is "g"
  raised to the "a" power mode 37 --- A = (g**a) % p.
</p>
<p>
  Do the same for "b" and "B".
</p>
<p>
  "A" and "B" are public keys. Generate a session key with them; set
  "s" to "B" raised to the "a" power mod 37 --- s = (B**a) % p.
</p>
<p>
  Do the same with A**b, check that you come up with the same "s".
</p>
<p>
  To turn "s" into a key, you can just hash it to create 128 bits of
  key material (or SHA256 it to create a key for encrypting and a key
  for a MAC).
</p>
<p>
  Ok,  that was fun, now repeat the exercise with bignums like in the real
  world. Here are parameters NIST likes:
</p>
<pre>p:
ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024
e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd
3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec
6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f
24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361
c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552
bb9ed529077096966d670c354e4abc9804f1746c08ca237327fff
fffffffffffff
 
g: 2</pre>
<p>
  This is very easy to do in Python or Ruby or other high-level
  languages that auto-promote fixnums to bignums, but it isn't "hard"
  anywhere.
</p>
<p>
  Note that you'll need to write your own modexp (this is blackboard
  math, don't freak out), because you'll blow out your bignum library
  raising "a" to the 1024-bit-numberth power. You can find modexp
  routines on Rosetta Code for most languages.
</p>

        </div>
      </div>
   </div>
   <div style="text-align:center"><a href="https://cryptoservices.github.io/">Cryptography Services</a> | <a href="https://www.nccgroup.trust/us/">NCC Group</a></div>
  </body>
  <script>
    /*var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-68682-6']);
    _gaq.push(['_trackPageview']);
    
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();*/
  </script>
</html>